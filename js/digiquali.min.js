window.digiquali||(window.digiquali={},window.digiquali.scriptsLoaded=!1),window.digiquali.scriptsLoaded||(window.digiquali.init=function(){window.digiquali.load_list_script()},window.digiquali.load_list_script=function(){if(!window.digiquali.scriptsLoaded){var i=void 0,o=void 0;for(i in window.digiquali)for(o in window.digiquali[i].init&&window.digiquali[i].init(),window.digiquali[i])window.digiquali[i]&&window.digiquali[i][o]&&window.digiquali[i][o].init&&window.digiquali[i][o].init();window.digiquali.scriptsLoaded=!0}},window.digiquali.refresh=function(){var i=void 0,o=void 0;for(i in window.digiquali)for(o in window.digiquali[i].refresh&&window.digiquali[i].refresh(),window.digiquali[i])window.digiquali[i]&&window.digiquali[i][o]&&window.digiquali[i][o].refresh&&window.digiquali[i][o].refresh()},$(document).ready(window.digiquali.init)),window.digiquali.control={},window.digiquali.control.init=function(){window.digiquali.control.event()},window.digiquali.control.event=function(){$(document).on("click",".answer:not(.disable)",window.digiquali.control.selectAnswer),$(document).on("input",".input-answer:not(.disable)",window.digiquali.control.selectAnswer),$(document).on("change",".control-table.linked-objects select",window.digiquali.control.disableOtherSelectors),$(document).on("keyup",".question-comment",window.digiquali.control.showCommentUnsaved),$(document).on("click",".validateButton",window.digiquali.control.getAnswerCounter),$(document).on("change","#fk_sheet",window.digiquali.control.showSelectObjectLinked),$(document).on("click",".toggleControlInfo",window.digiquali.control.toggleControlInfo),$(document).on("click",".clipboard-copy",window.digiquali.control.copyToClipboard),$(document).on("change","#productId",window.digiquali.control.refreshLotSelector),$(document).on("click",".switch-public-control-view",window.digiquali.control.switchPublicControlView),$(document).on("click",".show-only-questions-with-no-answer",window.digiquali.control.showOnlyQuestionsWithNoAnswer)},window.digiquali.control.selectAnswer=function(i){var o=$(this).closest(".select-answer.answer-cell"),t=o.attr("data-questionId"),e=$(this).closest(".table-id-"+t).attr("data-publicInterface"),n=$(this).closest(".table-id-"+t).attr("data-autoSave");let s="";var a=$(this).hasClass("answer")?$(this).attr("value"):$(this).val(),l=$(this).closest(".table-id-"+t).find("#comment"+t).val();if($(this).closest(".table-cell").hasClass("select-answer")){if($(this).hasClass("multiple-answers")){$(this).closest("span").toggleClass("active");let i=[];o.find(".multiple-answers.active").each(function(){i.push($(this).attr("value"))}),s=i}else $(this).closest(".table-cell").find(".answer.active").css("background-color","#fff"),$(this).closest(".table-cell").find("span").removeClass("active"),$(this).closest("span").addClass("active"),s=a;$(this).hasClass("active")?(o=$(this).closest(".answer-cell").find(".answer-color-"+$(this).attr("value")).val(),$(this).attr("style",$(this).attr("style")+" background:"+o+";")):$(this).attr("style",$(this).attr("style")+" background:#fff;"),$(this).closest(".answer-cell").find(".question-answer").val(s)}e||1!=n||$(this).hasClass("multiple-answers")?window.digiquali.control.updateButtonsStatus():window.digiquali.control.saveAnswer(t,s,l)},window.digiquali.control.disableOtherSelectors=function(i){var o=document.getElementById("createControlForm"),o=new FormData(o),t=$(this).attr("id");0<=o.get(t)?$(".control-table.linked-objects").find("select").not("#"+t).attr("disabled",1):$(".control-table.linked-objects").find("select").not("#"+t).removeAttr("disabled")},window.digiquali.control.showCommentUnsaved=function(i){$(this).hasClass("show-comment-unsaved-message")||($(this).after('<p style="color:red">Commentaire non enregistr√©</p>'),$(this).addClass("show-comment-unsaved-message")),window.digiquali.control.updateButtonsStatus()},window.digiquali.control.updateButtonsStatus=function(){$("#saveButton").removeClass("butActionRefused"),$("#saveButton").addClass("butAction"),$("#saveButton").css("background","#0d8aff"),$(".fa-circle").css("display","inline"),$("#saveButton").attr("onclick",'$("#saveControl").submit()'),$(".validateButton").removeClass("butAction"),$("#dialog-confirm-actionButtonValidate").removeAttr("id"),$(".validateButton").addClass("butActionRefused")},window.digiquali.control.getAnswerCounter=function(i){let o=0;jQuery("#tablelines").children().each(function(){0<$(this).find(".answer.active").length&&(o+=1)}),document.cookie="answerCounter="+o},window.digiquali.control.showSelectObjectLinked=function(){var i=$(this).val(),o=window.saturne.toolbox.getToken(),t=window.saturne.toolbox.getQuerySeparator(document.URL),t=document.URL+t+"fk_sheet="+i+"&token="+o;window.saturne.loader.display($(".linked-objects")),$.ajax({url:t,type:"POST",processData:!1,contentType:!1,success:function(i){$(".linked-objects").replaceWith($(i).find(".linked-objects"))},error:function(){}})},window.digiquali.control.toggleControlInfo=function(i){$(this).hasClass("fa-minus-square")?($(this).removeClass("fa-minus-square").addClass("fa-caret-square-down"),$(this).closest(".fiche").find(".fichecenter.controlInfo").addClass("hidden")):($(this).removeClass("fa-caret-square-down").addClass("fa-minus-square"),$(this).closest(".fiche").find(".fichecenter.controlInfo").removeClass("hidden"))},window.digiquali.control.copyToClipboard=function(i){var o=$(".copy-to-clipboard").attr("value");navigator.clipboard.writeText(o).then(()=>{$(".clipboard-copy").animate({backgroundColor:"#59ed9c"},200,()=>{$(".clipboard-copy").attr("class","fas fa-check  clipboard-copy"),$(this).tooltip({items:".clipboard-copy",content:$("#copyToClipboardTooltip").val()}),$(this).tooltip("open"),$(".clipboard-copy").attr("style","")})})},window.digiquali.control.refreshLotSelector=function(i){var o=document.getElementById("add_control_equipment"),o=new FormData(o),t=window.saturne.toolbox.getToken(),o=o.get("productId"),t=document.URL+"&token="+t;t+="&fk_product="+o,window.saturne.loader.display($(".product-lot")),$.ajax({url:t,type:"POST",processData:!1,contentType:!1,success:function(i){$(".product-lot").replaceWith($(i).find(".product-lot"))},error:function(){}})},window.digiquali.control.switchPublicControlView=function(i){var o=$(this).find(".public-control-view").val(),t=window.saturne.toolbox.getToken();let e=document.URL+"&token="+t;e+=0==o?"&show_control_list=1":"&show_last_control=1",window.saturne.loader.display($(".signature-container")),$.ajax({url:e,type:"POST",processData:!1,contentType:!1,success:function(i){$("#publicControlHistory").replaceWith($(i).find("#publicControlHistory"))},error:function(){}})},window.digiquali.control.showOnlyQuestionsWithNoAnswer=function(){var i=window.saturne.toolbox.getQuerySeparator(document.URL),o=window.saturne.toolbox.getToken();let t;t=$(this).hasClass("fa-toggle-off")?1:0,window.saturne.loader.display($(this)),$.ajax({url:document.URL+i+"action=show_only_questions_with_no_answer&token="+o,type:"POST",processData:!1,data:JSON.stringify({showOnlyQuestionsWithNoAnswer:t}),contentType:!1,success:function(i){$(".questionLines").replaceWith($(i).find(".questionLines"))},error:function(){}})},window.digiquali.control.saveAnswer=function(o,i,t){var e=window.saturne.toolbox.getToken(),n=window.saturne.toolbox.getQuerySeparator(document.URL);window.saturne.loader.display($(".table-id-"+o)),$.ajax({url:document.URL+n+"action=save&token="+e,type:"POST",data:JSON.stringify({autoSave:!0,questionId:o,answer:i,comment:t}),processData:!1,contentType:!1,success:function(i){$(".progress-info").replaceWith($(i).find(".progress-info")),$(".table-id-"+o).replaceWith($(i).find(".table-id-"+o))},error:function(){}})},window.digiquali.question={},window.digiquali.question.init=function(){window.digiquali.question.event()},window.digiquali.question.event=function(){$(document).on("click",".clicked-photo-preview",window.digiquali.question.previewPhoto),$(document).on("click",".ui-dialog-titlebar-close",window.digiquali.question.closePreviewPhoto),$(document).on("click","#show_photo",window.digiquali.question.showPhoto),$(document).on("click",".answer-picto .item, .wpeo-table .item",window.digiquali.question.selectAnswerPicto)},window.digiquali.question.previewPhoto=function(i){$(this).hasClass("photo-ok")?$("#dialogforpopup").attr("style","border: 10px solid #47e58e"):$(this).hasClass("photo-ko")&&$("#dialogforpopup").attr("style","border: 10px solid #e05353")},window.digiquali.question.closePreviewPhoto=function(i){$("#dialogforpopup").attr("style","border:")},window.digiquali.question.showPhoto=function(){var i=$(this).closest(".question-table").find(".linked-medias");i.hasClass("hidden")?(i.attr("style",""),i.removeClass("hidden")):(i.attr("style","display:none"),i.addClass("hidden"))},window.digiquali.question.selectAnswerPicto=function(i){var o=$(this).closest(".wpeo-dropdown");$(this).closest(".content").removeClass("active"),o.find(".dropdown-toggle span").hide(),o.find(".dropdown-toggle.button-picto").html($(this).closest(".wpeo-tooltip-event").html()),o.find(".input-hidden-picto").val($(this).data("label"))},window.digiquali.sheet={},window.digiquali.sheet.init=function(){window.digiquali.sheet.event()},window.digiquali.sheet.event=function(){};